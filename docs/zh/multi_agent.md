---
search:
  exclude: true
---
# 多智能体编排

编排指的是你在应用中对智能体的流程控制：运行哪些智能体、以什么顺序运行，以及它们如何决定下一步做什么。编排智能体主要有两种方式：

1. 让 LLM 决策：利用 LLM 的智能进行规划、推理，并据此决定采取哪些步骤。
2. 通过代码编排：通过你的代码决定智能体的流程。

你可以混合搭配这些模式。每种方式都有各自的权衡，详见下文。

## 通过 LLM 编排

一个智能体是一个具备 instructions、tools 和 任务转移 的 LLM。这意味着在给定一个开放式任务时，LLM 能够自主规划如何完成任务，使用工具采取行动并获取数据，并通过任务转移将任务委派给子智能体。比如，一个研究型智能体可以配备如下工具：

- 网络检索以在线查找信息
- 文件检索与读取以搜索专有数据和连接
- 计算机操作以在计算机上执行操作
- 代码执行以进行数据分析
- 任务转移至擅长规划、报告撰写等的专用智能体

当任务是开放式且你希望依赖 LLM 的智能时，此模式非常适合。这里最重要的策略包括：

1. 投入精力打磨提示词。清楚说明可用的工具、如何使用它们，以及必须遵循的 参数 范围。
2. 监控你的应用并持续迭代。观察问题出现在哪里，并迭代优化提示词。
3. 允许智能体自省与改进。例如，将其运行在循环中，让其自我评估；或者提供错误信息以便其改进。
4. 使用在单一任务上表现突出的专用智能体，而不是期望一个通用智能体在所有方面都足够出色。
5. 投入于[评测 (evals)](https://platform.openai.com/docs/guides/evals)。这有助于训练你的智能体不断改进并更好地完成任务。

## 通过代码编排

虽然通过 LLM 编排功能强大，但通过代码编排能让任务在速度、成本和性能方面更加确定且可预测。常见模式包括：

- 使用[structured outputs](https://platform.openai.com/docs/guides/structured-outputs)生成你可用代码检查的 格式良好的数据。比如，你可以让智能体将任务归类到几个目录，然后根据该目录选择下一个智能体。
- 将多个智能体串联，把一个智能体的输出转换为下一个的输入。你可以将撰写博客文章之类的任务分解为一系列步骤——做研究、写大纲、写正文、批评性审阅，然后改进。
- 让执行任务的智能体与负责评估并提供反馈的智能体一起在 `while` 循环中运行，直到评估者认为输出满足某些标准。
- 并行运行多个智能体，例如通过 Python 基本组件如 `asyncio.gather`。当你有多个彼此独立的任务时，这有助于加速。

我们在[`examples/agent_patterns`](https://github.com/openai/openai-agents-python/tree/main/examples/agent_patterns)中提供了诸多 code examples。